From 2763a1d95816168551ba6829f87961b8caf50446 Mon Sep 17 00:00:00 2001
From: "Uwe L. Korn" <uwe.korn@quantco.com>
Date: Thu, 10 Jun 2021 21:51:53 +0200
Subject: [PATCH 1/2] Use aws-* libs from PREFIX

Omit lib dir
---
 setup.py | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/setup.py b/setup.py
index ab99f8e..a7e7c09 100644
--- a/setup.py
+++ b/setup.py
@@ -262,8 +262,6 @@ class awscrt_build_ext(setuptools.command.build_ext.build_ext):
         # build dependencies
         dep_build_dir = os.path.join(self.build_temp, 'deps')
         dep_install_path = os.path.join(self.build_temp, 'deps', 'install')
-        for lib in AWS_LIBS:
-            self._build_dependency(lib, dep_build_dir, dep_install_path)
 
         # update paths so awscrt_ext can access dependencies
         self.include_dirs.append(os.path.join(dep_install_path, 'include'))
@@ -275,8 +273,6 @@ class awscrt_build_ext(setuptools.command.build_ext.build_ext):
         if is_32bit() and os.path.exists(os.path.join(dep_install_path, 'lib32')):
             lib_dir = 'lib32'
 
-        self.library_dirs.append(os.path.join(dep_install_path, lib_dir))
-
         # continue with normal build_ext.run()
         super().run()
 
@@ -306,7 +302,7 @@ def awscrt_ext():
     else:  # unix
         # linker will prefer shared libraries over static if it can find both.
         # force linker to choose static variant by using using "-l:libcrypto.a" syntax instead of just "-lcrypto".
-        libraries = [':lib{}.a'.format(x) for x in libraries]
+        libraries = ['{}'.format(x) for x in libraries]
         libraries += ['rt']
 
         # python usually adds -pthread automatically, but we've observed
-- 
2.32.1 (Apple Git-133)

